
<!-- 
  {% if page.switches contains "request-" %}
  If browser tem a funcao
    if server tem permissao
      nada
    else server nao tem a funcao
      #request
  else browser nao tem a funcao
    #sorry
    {% endif %} -->

<style>
#request {
   background-color: rgba(0, 0, 0, .4);
   position: absolute;
   top: 0;
   left: 0;
   width: 100vw;
   height: 100vh;
}
 #request .modal {
   background-color: white;
   width: 300px;
   margin: 0 auto;
   padding: 20px;
}
 #request .modal .icon svg {
   width: 80px;
   path: #333;
}
 #request .checklist {
   border-top: dashed 1px purple;
}
 #request .checklist a {
   font-weight: bold;
   display: block;
   padding: 10px;
   border-bottom: dashed 1px purple;
   background-color: white;
   text-decoration: none;
}
 #request .checklist a:hover {
   background-color: #ffe6ff;
   color: purple;
}
 #request .checklist a:hover svg {
   path: purple;
}
 #request .checklist a svg {
   width: 20px;
   height: 20px;
   margin-right: 10px;
}
 .launch {
   text-decoration: none;
   background-color: purple;
   color: white;
   display: block;
   text-align: center;
   padding: 10px;
   margin-top: 20px;
   font-size: 130%;
   border: solid 1px white;
   font-weight: bold;
}
 .launch:hover {
   margin-top: 20px;
}
</style>

 {% if page.switches contains "request-" %}
 <div id="request">
  <div class="modal">
    <div class="icon"></div>
    <div class="checklist">
 <a class="motion" href="#" onclick='requestMotionPermission();'>blank javascript</a>
 <a class="motion" href="#" onclick='motionAccess()'>integrated javascript</a>
   </div>

   <a href="JavaScript:void(0)" class="launch" onClick='var element = document.getElementById("request");
   element.classList.add("closed");
   '>
 âœ¨ Launch</a>
</div>
</div>
 <script>
 	let button;
 	let motionSupport;
 	let motionGranted;

 	function setup() {
 		createCanvas(500, 500);

 		if (typeof(DeviceMotionEvent) !== 'undefined' && typeof(DeviceMotionEvent.requestPermission) === 'function') {
 			motionSupport = true;
text("please let me in", 100, 100);
 		}
 		else {
 			motionSupport = false;
 			text("sorry loser", 100, 100);
 		}
 	}



 	function motionAccess() {
 		DeviceMotionEvent.requestPermission() 
 		.then(response => {
 			if (response == 'granted') {
 				motionGranted = true;
 			} else {
 				motionGranted = false;
 			}

 		})
 		.catch(console.error);
 	}

 	function draw() {
motionAccess();
noLoop;
  // if (motionSupport) {
  // 	if (motionGranted) {
  // 		text("yay!", 100, 100);

  // 	} else {
  // 		text("fuck you", 100, 100);
  // 	}

  // } else {
  // 	text("sorry loser", 100, 100);
  // }

}

</script>
{% endif %}
